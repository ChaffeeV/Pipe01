#include <stdio.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <unistd.h>

int stat;
char string[500];
int i=0;
char c;

int main(){
	FILE *fp;
	pid_t pid;
	int fd[2];
	size_t flag, size;
	if (pipe(fd) < 0){
		printf ("Can't create pipe\n");
		exit(-1);
	}
	pid = fork();
	if (pid == -1){
		printf ("some error happened\n");
		exit(-1);
	}
	else if (pid == 0){
		close(fd[0]);
		freopen("OUTPUT", "w", stdout);
		system("ls -l");
		close(fd[1]);
		exit(-1);
		fp = fopen("OUTPUT", "r");
		i=0;
		while ((c = getc(fp)) != EOF){
		string[i]=c;
		i++;	
		}
		string[i]='\0';
		printf("%s", string);
	}
	else{
		wait(&stat);
		close(fd[1]);
		size = read(fd[0], string, 100);
		if (size<0){
			printf(" Не могу прочитать\n");
		}
		printf("Родительский процесс. Введенная строка: %s\n", string);
		close(fd[0]);
	}
	return 0;
}

		

	
